import{a as B,b as P}from"./chunk-ZROBSYIW.js";import{a as $}from"./chunk-DIDSKB7T.js";import{b as V,e as j,f as q,g as A,i as c,j as G,k as M,l as O,m as U,o as Q}from"./chunk-6SYXPBD6.js";import{a as I}from"./chunk-ZYTFNW7I.js";import{C,D as _,L as y,S as s,T as m,Ya as x,Z as S,_a as R,ca as d,eb as D,fb as g,ga as E,ha as F,ia as k,ja as r,k as v,ka as o,la as p,oa as N,pa as u,qa as T,ua as h,wa as L,y as b,za as w}from"./chunk-IVXWDJCI.js";import"./chunk-OLEEAF3F.js";function z(a,n){if(a&1){let f=N();r(0,"span",14)(1,"i",15),u("click",function(){let i=C(f).$implicit,l=T();return _(l.removeTag(i))}),o(),h(2),o()}if(a&2){let f=n.$implicit;s(2),L(" ",f," ")}}var ae=(()=>{let n=class n{changedEditor(e){}constructor(e,t,i,l){this.articleService=e,this.route=t,this.router=i,this.userService=l,this.tagList=[],this.articleForm=new A({title:new c("",{nonNullable:!0}),description:new c("",{nonNullable:!0}),body:new c("",{nonNullable:!0})}),this.tagField=new c("",{nonNullable:!0}),this.mode="add",this.errors=null,this.isSubmitting=!1,this.destroyRef=y(S),this.quillConfig={toolbar:[[{header:[]},"bold","italic","underline","strike",{color:[]},{background:[]},{list:"ordered"},{list:"bullet"},{align:[!1,"right","center"]},{indent:"-1"},{indent:"+1"},"link","image","blockquote","code","clean"]]}}ngOnInit(){this.route.snapshot.params.slug&&v([this.articleService.get(this.route.snapshot.params.slug),this.userService.getCurrentUser()]).pipe(g(this.destroyRef)).subscribe(([e,{user:t}])=>{t.username===e.author.username?(this.tagList=e.tagList,this.mode="edit",this.articleForm.patchValue(e)):this.router.navigate(["/"])})}addTag(){let e=this.tagField.value;e!=null&&e.trim()!==""&&this.tagList.indexOf(e)<0&&this.tagList.push(e),this.tagField.reset("")}removeTag(e){this.tagList=this.tagList.filter(t=>t!==e)}submitForm(){this.isSubmitting=!0,this.addTag();let e=this.articleForm.value;e.slug=this.route.snapshot.params.slug||"",e.tagList=this.tagList,this.mode=="edit"?this.articleService.update(e).pipe(g(this.destroyRef)).subscribe({next:t=>this.router.navigate(["/article/",t.slug]),error:t=>{this.errors=t,this.isSubmitting=!1}}):this.articleService.create(e).pipe(g(this.destroyRef)).subscribe({next:t=>this.router.navigate(["/article/",t.slug]),error:t=>{this.errors=t,this.isSubmitting=!1}})}};n.\u0275fac=function(t){return new(t||n)(m(I),m(x),m(R),m(D))},n.\u0275cmp=b({type:n,selectors:[["app-editor-page"]],standalone:!0,features:[w],decls:20,vars:7,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"errors"],[3,"formGroup"],[3,"disabled"],[1,"form-group"],["formControlName","title","type","text","placeholder","Article Title",1,"form-control","form-control-lg"],["dir","auto","formControlName","description","type","text","placeholder","What's this article about?",1,"form-control"],[1,"text-editor",3,"formControlName","modules","dir","onEditorChanged"],["type","text","placeholder","Enter tags",1,"form-control",3,"formControl","keyup.enter"],[1,"tag-list"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"],[1,"tag-default","tag-pill"],[1,"ion-close-round",3,"click"],["class","tag-default tag-pill"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p(4,"app-list-errors",4),r(5,"form",5)(6,"fieldset",6)(7,"fieldset",7),p(8,"input",8),o(),r(9,"fieldset",7),p(10,"input",9),o(),r(11,"fieldset",7)(12,"quill-editor",10),u("onEditorChanged",function(W){return i.changedEditor(W)}),o()(),r(13,"fieldset",7)(14,"input",11),u("keyup.enter",function(){return i.addTag()}),o(),r(15,"div",12),F(16,z,3,1,"span",16,E),o()(),r(18,"button",13),u("click",function(){return i.submitForm()}),h(19," Publish Article "),o()()()()()()()),t&2&&(s(4),d("errors",i.errors),s(),d("formGroup",i.articleForm),s(),d("disabled",i.isSubmitting),s(6),d("formControlName","body")("modules",i.quillConfig)("dir","auto"),s(2),d("formControl",i.tagField),s(2),k(i.tagList))},dependencies:[$,Q,G,V,j,q,M,O,U,P,B],encapsulation:2});let a=n;return a})();export{ae as default};
